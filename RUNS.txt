0
popularity_hitrate@5   0.03, 0.47, 0.82

0.5
popularity_hitrate@5   0.06, 0.46, 0.71

0.8
popularity_hitrate@5   0.07, 0.4, 0.58

1
popularity_hitrate@5   0.1, 0.37, 0.48 / (increasing number of pairs) popularity_hitrate@5   0.16, 0.41, 0.45

1.5
popularity_hitrate@5   0.22, 0.05, 0.0

2 componenti

--------
1
popularity_hitrate@5   0.09, 0.38, 0.59

V3, pairs:20,
settings.batch_size = 1024  # 256
settings.learning_rate = 1e-4

>>>> hitrate@5              0.41734943501727956
>>>> popularity_hitrate@5   0.14, 0.38, 0.5

======== 20
0.16, 0.37, 0.47








RISULTATI

***************************************************************************

Sembra che applicando la frequenza al numero di coppie si abbiano risultati
migliori rispetto all'applicazione delle frequenze alla loss

bvlsfn78l43d086g
Angelo+stefy7078

=============
MOVIE LENS 1M
=============

BASELINE:
popularity_hitrate@5   0.04, 0.46, 0.82

PAIRS:
popularity_hitrate@5   0.18, 0.38, 0.39

ENSEMBLE 3
popularity_hitrate@5   0.13, 0.39, 0.57

ENSEMBLE 3 NO NN
popularity_hitrate@5   0.19, 0.26, 0.79
popularity_hitrate@5   0.25, 0.23, 0.79
popularity_hitrate@5   0.20, 0.23, 0.84 soglia minima, ... * 0.001 (1-x)
popularity_hitrate@5:  0.24, 0.19, 0.84 <----

ENSEMBLE 3 NN
popularity_hitrate@5:  0.14, 0.45, 0.72
popularity_hitrate@5: 0.11, 0.45, 0.73

ENSEMBLE 2 NN
popularity_hitrate@5:  0.13, 0.43, 0.61

ENSEMBLE 2 NO NN
hitrate@5              0.45284044577330795
popularity_hitrate@5   0.37, 0.32, 0.7






low_pop: 953
med_pop: 2367
high_pop: 142

ENSEMBLE 2 BEST 2 ensemble_2m_no_nn_best_v2.py
=======================================================
popularity_hitrate@5: 0.04, 0.46, 0.82 (0.00) 0.5730 BASELINE
popularity_hitrate@5: 0.10, 0.44, 0.82 (0.15)
popularity_hitrate@5: 0.12, 0.44, 0.81 (0.20) 0.5625
popularity_hitrate@5: 0.20, 0.43, 0.80 (0.33) 0.5489
popularity_hitrate@5: 0.23, 0.41, 0.80 (0.40) 0.5407
popularity_hitrate@5: 0.36, 0.35, 0.74 (0.80)
popularity_hitrate@5: 0.40, 0.32, 0.72 (1.00)
=======================================================

ENSEMBLE 2 BEST 2 ensemble_2m_no_nn_best_v3.py
=======================================================
popularity_hitrate@5: 0.31, 0.39, 0.78 (0.5747, 0.2826)
=======================================================














2 Lin - 1 Lin
---------------------------------------------------------------------------------------------------------------------------
| Epoch   4 | time: 43.74s | train_loss: 0.2968 | loss: 0.4446 | hitrate@5: 0.3408 | popularity_hitrate@5: 0.2, 0.3, 0.42 |
---------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------
| Epoch   5 | time: 44.94s | train_loss: 0.2674 | loss: 0.4374 | hitrate@5: 0.3672 | popularity_hitrate@5: 0.22, 0.32, 0.46 |
-----------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------
| Epoch  10 | time: 47.88s | train_loss: 0.1810 | loss: 0.4336 | hitrate@5: 0.4023 | popularity_hitrate@5: 0.21, 0.35, 0.5 |
----------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------
| Epoch  30 | time: 44.56s | train_loss: 0.1124 | loss: 0.4803 | hitrate@5: 0.4411 | popularity_hitrate@5: 0.16, 0.39, 0.54 |
-----------------------------------------------------------------------------------------------------------------------------

3 Lin - 1 Lin
-----------------------------------------------------------------------------------------------------------------------------
| Epoch  30 | time: 18.69s | train_loss: 0.3634 | loss: 0.6103 | hitrate@5: 0.5531 | popularity_hitrate@5: 0.03, 0.45, 0.76 |
-----------------------------------------------------------------------------------------------------------------------------

3 Lin - 3 Relu - 1 Lin
-----------------------------------------------------------------------------------------------------------------------------
| Epoch  30 | time: 20.04s | train_loss: 0.1568 | loss: 0.5075 | hitrate@5: 0.4381 | popularity_hitrate@5: 0.18, 0.37, 0.57 |
-----------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------
| Epoch  60 | time: 20.61s | train_loss: 0.1068 | loss: 0.6139 | hitrate@5: 0.4584 | popularity_hitrate@5: 0.16, 0.39, 0.6 |
----------------------------------------------------------------------------------------------------------------------------

3 Lin - 3 Relu - 3 Lin - 1 Lin - 1 Relu - 1 Lin
-----------------------------------------------------------------------------------------------------------------------------
| Epoch  10 | time: 19.07s | train_loss: 0.3284 | loss: 0.4906 | hitrate@5: 0.3082 | popularity_hitrate@5: 0.14, 0.26, 0.41 |
-----------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------
| Epoch  15 | time: 19.11s | train_loss: 0.2654 | loss: 0.5002 | hitrate@5: 0.3514 | popularity_hitrate@5: 0.2, 0.29, 0.48 |
----------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------
| Epoch  18 | time: 18.10s | train_loss: 0.2399 | loss: 0.5192 | hitrate@5: 0.3537 | popularity_hitrate@5: 0.21, 0.3, 0.46 |
----------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------
| Epoch  30 | time: 19.03s | train_loss: 0.1716 | loss: 0.6330 | hitrate@5: 0.3692 | popularity_hitrate@5: 0.21, 0.33, 0.46 |
-----------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------
| Epoch  49 | time: 18.83s | train_loss: 0.1147 | loss: 0.9001 | hitrate@5: 0.3973 | popularity_hitrate@5: 0.16, 0.35, 0.5 |
----------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------
| Epoch  50 | time: 18.69s | train_loss: 0.1135 | loss: 0.9107 | hitrate@5: 0.3906 | popularity_hitrate@5: 0.17, 0.34, 0.49 |
-----------------------------------------------------------------------------------------------------------------------------


3 Lin - 3 Relu - 3 Lin - 3 Relu - 1 Lin
-----------------------------------------------------------------------------------------------------------------------------
| Epoch  10 | time: 21.05s | train_loss: 0.2579 | loss: 0.4636 | hitrate@5: 0.3699 | popularity_hitrate@5: 0.18, 0.32, 0.47 |
-----------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------
| Epoch  11 | time: 20.37s | train_loss: 0.2436 | loss: 0.4694 | hitrate@5: 0.3880 | popularity_hitrate@5: 0.23, 0.33, 0.5 |
----------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------
| Epoch  15 | time: 18.17s | train_loss: 0.2078 | loss: 0.4860 | hitrate@5: 0.4121 | popularity_hitrate@5: 0.2, 0.35, 0.54 |
----------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------
| Epoch  30 | time: 19.24s | train_loss: 0.1382 | loss: 0.6225 | hitrate@5: 0.4231 | popularity_hitrate@5: 0.21, 0.37, 0.53 |
-----------------------------------------------------------------------------------------------------------------------------

3 Lin - 3 Relu - 3 Lin - 1 Lin
-----------------------------------------------------------------------------------------------------------------------------
| Epoch   1 | time: 22.12s | train_loss: 0.7356 | loss: 0.6595 | hitrate@5: 0.0828 | popularity_hitrate@5: 0.09, 0.06, 0.13 |
-----------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------
| Epoch   4 | time: 18.91s | train_loss: 0.3807 | loss: 0.4742 | hitrate@5: 0.3407 | popularity_hitrate@5: 0.14, 0.28, 0.46 |
-----------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------
| Epoch  10 | time: 18.06s | train_loss: 0.2362 | loss: 0.4486 | hitrate@5: 0.4231 | popularity_hitrate@5: 0.2, 0.35, 0.57 |
----------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------
| Epoch  30 | time: 19.12s | train_loss: 0.1459 | loss: 0.5280 | hitrate@5: 0.4221 | popularity_hitrate@5: 0.19, 0.37, 0.52 |
-----------------------------------------------------------------------------------------------------------------------------

3 Lin - 3 Sigmoid - 3 Lin - 1 Lin

3 Lin - 3 Tanh - 3 Lin - 1 Lin
-----------------------------------------------------------------------------------------------------------------------------
| Epoch  10 | time: 18.41s | train_loss: 0.2406 | loss: 0.4358 | hitrate@5: 0.3762 | popularity_hitrate@5: 0.19, 0.33, 0.47 |
-----------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------
| Epoch  14 | time: 18.11s | train_loss: 0.2018 | loss: 0.4450 | hitrate@5: 0.3618 | popularity_hitrate@5: 0.2, 0.33, 0.42 |
----------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------
| Epoch  24 | time: 18.66s | train_loss: 0.1530 | loss: 0.4929 | hitrate@5: 0.3936 | popularity_hitrate@5: 0.23, 0.36, 0.45 |
-----------------------------------------------------------------------------------------------------------------------------

3 Bn - 3 Lin - 3 Sigmoid - 3 Lin - 1 Lin

last
-----------------------------------------------------------------------------------------------------------------------------
| Epoch  10 | time: 19.13s | train_loss: 0.1606 | loss: 0.4908 | hitrate@5: 0.4309 | popularity_hitrate@5: 0.18, 0.36, 0.56 |
-----------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------
| Epoch  25 | time: 20.91s | train_loss: 0.0974 | loss: 0.6219 | hitrate@5: 0.4423 | popularity_hitrate@5: 0.14, 0.39, 0.55 |
-----------------------------------------------------------------------------------------------------------------------------

=========
PINTEREST
=========

BASELINE:
popularity_hitrate@5   0.23, 0.7, 0.95

PAIRS:
popularity_hitrate@5   0.68, 0.65, 0.6

LOSS:
popularity_hitrate@5   0.57, 0.65, 0.67


------------------------------------------
hitrate@1              0.3407079646017699
hitrate@10             0.286193636746734
hitrate@5              0.3067846607669604
hitrate_by_pop@1       0.01,0.21,0.36
hitrate_by_pop@10      0.00,0.15,0.29
hitrate_by_pop@5       0.00,0.17,0.33
loss                   0.2170695811510086
recall@1               0.3407079646017699
recall@10              0.3032106111317714
recall@5               0.31043771043771046
train_loss             0.17477879524230958
weighted_hitrate@1     0.32104046856160356
weighted_hitrate@10    0.2685855053719639
weighted_hitrate@5     0.28688629880489747
weighted_recall@1      0.3165887213797534
weighted_recall@10     0.28235092884833335
weighted_recall@5      0.28810231265413855
K = 1000
hitrate@1              0.334070796460177
hitrate@10             0.29207534414945907
hitrate@5              0.31360619469026446
hitrate_by_pop@1       0.00,0.23,0.36
hitrate_by_pop@10      0.00,0.15,0.28
hitrate_by_pop@5       0.00,0.18,0.32
loss                   0.21956343948841095
recall@1               0.334070796460177
recall@10              0.3080074487895717
recall@5               0.31737469094178467
train_loss             0
weighted_hitrate@1     0.31569078443224213
weighted_hitrate@10    0.2735276661037397
weighted_hitrate@5     0.2936158028877312
weighted_recall@1      0.3063609466144025
weighted_recall@10     0.2855677500258245
weighted_recall@5      0.29353652176133893

------------------------------------------

hitrate@1              0.16924778761061948
hitrate@10             0.1394595448798987
hitrate@5              0.14762168141592977
hitrate_by_pop@1       0.01,0.12,0.39
hitrate_by_pop@10      0.00,0.09,0.28
hitrate_by_pop@5       0.01,0.10,0.33
loss                   0.44173431396484375
recall@1               0.16924778761061948
recall@10              0.14999380190901201
recall@5               0.14971941638608305
train_loss             0.17949062287807466
weighted_hitrate@1     0.17311292229665276
weighted_hitrate@10    0.14065588388893166
weighted_hitrate@5     0.1493137012282968
weighted_recall@1      0.16900000319416356
weighted_recall@10     0.15062301190797311
weighted_recall@5      0.14991360153617972
K = 1000



hitrate@1              0.13716814159292035
hitrate@10             0.11406359741536723
hitrate@5              0.11474926253687365
hitrate_by_pop@1       0.00,0.10,0.36
hitrate_by_pop@10      0.00,0.08,0.28
hitrate_by_pop@5       0.00,0.08,0.32
loss                   0.4453364610671997
recall@1               0.13716814159292035
recall@10              0.12203600248292985
recall@5               0.11643065857496067
train_loss             0
weighted_hitrate@1     0.14020115273156797
weighted_hitrate@10    0.11507032426150465
weighted_hitrate@5     0.11543743668894176
weighted_recall@1      0.14000147544027888
weighted_recall@10     0.12286109164769586
weighted_recall@5      0.1169118678519389
DONE ./data/ml-1m/results/run_ml-1m_20200929_1501_rvae_rank_pair_loss

Process finished with exit code 0


FIXED

POP=True

hitrate@1              0.16261061946902655
hitrate@10             0.13646052816406787
hitrate@5              0.1449668141592927
hitrate_by_pop@1       0.00,0.12,0.56
hitrate_by_pop@10      0.01,0.09,0.45
hitrate_by_pop@5       0.01,0.10,0.50
loss                   0.44005319476127625
recall@1               0.16261061946902655
recall@10              0.14677079459526465
recall@5               0.14702581369248036
train_loss             0.17948199212551116
weighted_hitrate@1     0.16261061946902655
weighted_hitrate@10    0.13717606152020234
weighted_hitrate@5     0.1456354276413077
weighted_recall@1      0.15897868134652302
weighted_recall@10     0.1469999064345562
weighted_recall@5      0.14644874711046937
K = 1000

hitrate@1              0.13606194690265486
hitrate@10             0.11385333263098733
hitrate@5              0.11386430678466135
hitrate_by_pop@1       0.00,0.11,0.47
hitrate_by_pop@10      0.00,0.08,0.41
hitrate_by_pop@5       0.00,0.08,0.45
loss                   0.4445972740650177
recall@1               0.13606194690265486
recall@10              0.12203600248292985
recall@5               0.11553158013036638
train_loss             0
weighted_hitrate@1     0.13606194690265486
weighted_hitrate@10    0.11421739727170865
weighted_hitrate@5     0.1139862857306261
weighted_recall@1      0.1350873053817963
weighted_recall@10     0.12229960719676798
weighted_recall@5      0.11507074718907251

POP=False

hitrate@1              0.33738938053097345
hitrate@10             0.28711722151987606
hitrate@5              0.30435103244837636
hitrate_by_pop@1       nan,0.30,0.35
hitrate_by_pop@10      0.00,0.19,0.32
hitrate_by_pop@5       0.00,0.23,0.33
loss                   0.21652339398860931
recall@1               0.33738938053097345
recall@10              0.3039543820503285
recall@5               0.3079685746352413
train_loss             0.17471846640110017
weighted_hitrate@1     0.33738938053097345
weighted_hitrate@10    0.2761875130010152
weighted_hitrate@5     0.297225458019393
weighted_recall@1      0.32970464996679133
weighted_recall@10     0.28798199856302825
weighted_recall@5      0.29420764592050863
K = 1000



hitrate@1              0.32964601769911506
hitrate@10             0.294966814159292
hitrate@5              0.31292404129793405
hitrate_by_pop@1       nan,0.27,0.35
hitrate_by_pop@10      nan,0.21,0.32
hitrate_by_pop@5       nan,0.25,0.35
loss                   0.21972867846488953
recall@1               0.32964601769911506
recall@10              0.31036623215394166
recall@5               0.31647561249719036
train_loss             0
weighted_hitrate@1     0.32964601769911506
weighted_hitrate@10    0.28305456306326676
weighted_hitrate@5     0.30517403985261243
weighted_recall@1      0.32159137282415157
weighted_recall@10     0.293366689618736
weighted_recall@5      0.301112187420866


==================
utenti:6031

---------------
>>> baseline
---------------
count_by_pop@1         0.00, 48.00,   226.00 (6031)
                       0%    0.8%     3.75%

count_by_pop@10        0.00, 480.00,  1790.00 (60310)
                       0%    0.8%     3%

count_by_pop@5         0.00, 218.00,  1032.00 (30155)
                       0%    0.72%    3.4%

----------------
>>> our approach
----------------
count_by_pop@1         0.00, 75.00,   106.00 (6031)
                       0%    1.2%     1.76%

count_by_pop@10        3.00, 686.00,  650.00 (60310)
                       0%    1.14%    1.%

count_by_pop@5         1.00, 349.00,  393.00 (30155)
                       0%    1.16%    1.3%



